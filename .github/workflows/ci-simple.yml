name: Simple Template Validation

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  validate-structure:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Validate Core Structure
      run: |
        echo "Checking core template structure..."
        
        # Check for essential directories
        if [ -d "CLIENT_TEMPLATE" ]; then
          echo "✓ CLIENT_TEMPLATE directory exists"
        else
          echo "❌ CLIENT_TEMPLATE directory missing"
          exit 1
        fi
        
        # Check for essential files (with graceful handling)
        if [ -f "README.md" ]; then
          echo "✓ Main README.md exists"
        else
          echo "⚠️ Main README.md missing (optional)"
        fi
        
        if [ -f "LICENSE" ]; then
          echo "✓ LICENSE exists"
        else
          echo "⚠️ LICENSE missing (recommended)"
        fi
        
        # Check CLIENT_TEMPLATE structure
        echo ""
        echo "CLIENT_TEMPLATE contents:"
        ls -la CLIENT_TEMPLATE/ 2>/dev/null || echo "Empty CLIENT_TEMPLATE"
        
        # Count important subdirectories
        DIRS_FOUND=0
        for dir in _context discovery roadmap sow_projects; do
          if [ -d "CLIENT_TEMPLATE/$dir" ]; then
            echo "✓ $dir directory exists"
            DIRS_FOUND=$((DIRS_FOUND + 1))
          else
            echo "⚠️ $dir directory missing"
          fi
        done
        
        echo ""
        echo "Summary: Found $DIRS_FOUND/4 expected directories"
        
        # Only fail if CLIENT_TEMPLATE is completely empty
        if [ "$DIRS_FOUND" -eq 0 ]; then
          echo "❌ CLIENT_TEMPLATE appears to be empty"
          exit 1
        fi
        
        echo "✅ Template structure validation passed!"
